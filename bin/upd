#!/bin/sh
cd "$(mktemp -d)" || exit

DOTFILES=~/.dotfiles

if [ -d "$DOTFILES" ]; then
  echo "[upd] updating dotfiles $DOTFILES..."
  (cd "$DOTFILES" && git pull)
fi

if command -v mise >/dev/null 2>&1; then
  echo "[upd] updating mise..."
  mise up
  rm -rf ~/.local/share/mise/shims && mise reshim
fi

if command -v sheldon >/dev/null 2>&1; then
  echo "[upd] updating sheldon..."
  sheldon lock --update
fi

if command -v yt-dlp >/dev/null 2>&1; then
  echo "[upd] updating yt-dlp..."
  yt-dlp --update-to nightly
fi

if command -v apt >/dev/null 2>&1; then
  echo "[upd] updating apt..."
  sudo apt update
  sudo apt upgrade -y
  sudo apt autoremove -y
fi

if command -v dnf >/dev/null 2>&1; then
  echo "[upd] updating dnf..."
  sudo dnf update -y
fi

if command -v brew >/dev/null 2>&1; then
  echo "[upd] updating brew..."
  brew bundle
  brew cu -af
  brew cleanup
  brew doctor
fi
cd - || exit
