#!/bin/bash

# Script to remove and reinstall Xcode Command Line Tools
# This can fix Homebrew cask installation issues related to Swift errors

echo "=== Xcode Command Line Tools Reinstallation ==="
echo "This script will remove existing Xcode Command Line Tools and reinstall them."
echo "This may help resolve Homebrew cask installation issues related to Swift errors."
echo ""

# Check if running as root/sudo
if [ "$(id -u)" != "0" ]; then
   echo "‚ö†Ô∏è  This script must be run with sudo privileges."
   echo "Please run: sudo $0"
   exit 1
fi

echo "üîç Checking for existing Xcode Command Line Tools installation..."

# Remove existing Command Line Tools
echo "üóëÔ∏è  Removing existing Xcode Command Line Tools..."
rm -rf /Library/Developer/CommandLineTools
echo "‚úÖ Removed existing installation."

# Clear xcode-select path
echo "üßπ Clearing xcode-select path..."
xcode-select --reset
echo "‚úÖ Path reset."

# Force the "Install Command Line Developer Tools" prompt
echo "üì• Triggering installation prompt for Command Line Tools..."
xcode-select --install

echo ""
echo "‚ú® Installation prompt has been triggered."
echo "üìã Please follow the prompts in the dialog box to complete installation."
echo ""
echo "After installation completes, you can verify it worked with:"
echo "   xcode-select -p"
echo "   gcc --version"
echo ""
echo "Then try your Homebrew commands again."
