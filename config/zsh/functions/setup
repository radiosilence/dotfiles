# Smart setup function - rebuilds Rust tooling first, then delegates
setup() {
  # If cargo and tooling-rust exist, rebuild first
  if command -v cargo &>/dev/null && [ -d ~/.dotfiles/tooling-rust ]; then
    printf "\033[35mü¶Ä [setup] rebuilding rust tooling...\033[0m\n"
    (cd ~/.dotfiles/tooling-rust && cargo install --path . --root .. --force --bin setup 2>&1 | grep -v "warning:")
  fi

  # If setup binary exists and is executable, use it
  if command -v ~/.dotfiles/bin/setup &>/dev/null; then
    ~/.dotfiles/bin/setup "$@"
    return $?
  fi

  # Bootstrap mode - use shell script
  printf "\n\033[1;33m‚ö†Ô∏è  [setup] Rust binary not found, using bootstrap script...\033[0m\n"

  if [ -f ~/.dotfiles/setup ]; then
    sh ~/.dotfiles/setup "$@"
  else
    printf "\033[31m‚úó [setup] setup script not found\033[0m\n"
    return 1
  fi
}
