# Smart install function - rebuilds Rust tooling first, then delegates
install() {
  # If cargo and tooling-rust exist, rebuild first
  if command -v cargo &>/dev/null && [ -d ~/.dotfiles/tooling-rust ]; then
    printf "\033[35mü¶Ä [install] rebuilding rust tooling...\033[0m\n"
    (cd ~/.dotfiles/tooling-rust && cargo install --path . --root .. --force --bin install 2>&1 | grep -v "warning:")
  fi

  # If install binary exists and is executable, use it
  if command -v ~/.dotfiles/bin/install &>/dev/null; then
    ~/.dotfiles/bin/install "$@"
    return $?
  fi

  # Bootstrap mode - use shell script
  printf "\n\033[1;33m‚ö†Ô∏è  [install] Rust binary not found, using shell script...\033[0m\n"

  if [ -f ~/.dotfiles/install ]; then
    sh ~/.dotfiles/install
  else
    printf "\033[31m‚úó [install] install script not found\033[0m\n"
    return 1
  fi
}
