# Smart install-dotfiles function - rebuilds Rust tooling first, then delegates
install-dotfiles() {
  # If cargo and tooling-rust exist, rebuild first
  if command -v cargo &>/dev/null && [ -d ~/.dotfiles/tooling-rust ]; then
    printf "\033[35mü¶Ä [install-dotfiles] rebuilding rust tooling...\033[0m\n"
    (cd ~/.dotfiles/tooling-rust && cargo install --path . --root .. --force --bin install-dotfiles 2>&1 | grep -v "warning:")
  fi

  # If install-dotfiles binary exists and is executable, use it
  if command -v ~/.dotfiles/bin/install-dotfiles &>/dev/null; then
    ~/.dotfiles/bin/install-dotfiles "$@"
    return $?
  fi

  # Bootstrap mode - use shell script
  printf "\n\033[1;33m‚ö†Ô∏è  [install-dotfiles] Rust binary not found, using shell script...\033[0m\n"

  if [ -f ~/.dotfiles/install ]; then
    sh ~/.dotfiles/install
  else
    printf "\033[31m‚úó [install-dotfiles] install script not found\033[0m\n"
    return 1
  fi
}
